<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>学习心得分享</title>
</head>
<body>
<link href="istyle.css" rel="stylesheet"/>
<div class="bgLoading" id="loadingBg">
    <svg t="1582963174647" class="loading" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
         p-id="3662">
        <path d="M955.733333 765.866667c0 0 0 2.133333 0 2.133333-12.8 21.333333-38.4 27.733333-57.6 14.933333-19.2-10.666667-27.733333-36.266667-17.066667-57.6l0 0c36.266667-64 57.6-136.533333 57.6-213.333333s-21.333333-151.466667-57.6-213.333333l0 0c-10.666667-19.2-4.266667-44.8 17.066667-57.6 21.333333-12.8 46.933333-4.266667 57.6 14.933333 0 0 0 2.133333 0 2.133333 42.666667 74.666667 68.266667 162.133333 68.266667 253.866667S998.4 691.2 955.733333 765.866667zM768 955.733333C768 955.733333 765.866667 955.733333 768 955.733333c-76.8 42.666667-164.266667 68.266667-256 68.266667s-179.2-25.6-253.866667-68.266667c0 0-2.133333 0-2.133333 0-21.333333-12.8-27.733333-38.4-14.933333-57.6 12.8-21.333333 38.4-27.733333 57.6-14.933333 0 0 0 0 2.133333 0l0 0C362.666667 917.333333 435.2 938.666667 512 938.666667s149.333333-21.333333 211.2-57.6l0 0c0 0 0 0 2.133333 0 21.333333-12.8 46.933333-4.266667 57.6 14.933333C795.733333 917.333333 789.333333 942.933333 768 955.733333zM727.466667 142.933333 727.466667 142.933333C663.466667 106.666667 590.933333 85.333333 512 85.333333s-151.466667 21.333333-213.333333 57.6l0 0c-19.2 10.666667-44.8 4.266667-57.6-17.066667C228.266667 106.666667 234.666667 81.066667 256 68.266667c0 0 2.133333 0 2.133333 0C332.8 25.6 420.266667 0 512 0s179.2 25.6 253.866667 68.266667c0 0 2.133333 0 2.133333 0 21.333333 12.8 27.733333 38.4 14.933333 57.6C772.266667 147.2 746.666667 153.6 727.466667 142.933333zM125.866667 782.933333C106.666667 795.733333 81.066667 789.333333 68.266667 768c0 0 0-2.133333 0-2.133333C25.6 691.2 0 603.733333 0 512s25.6-179.2 68.266667-253.866667c0 0 0-2.133333 0-2.133333 12.8-21.333333 38.4-27.733333 57.6-14.933333 21.333333 12.8 27.733333 38.4 14.933333 57.6 0 0 0 0 0 2.133333l0 0C106.666667 362.666667 85.333333 435.2 85.333333 512s21.333333 149.333333 57.6 211.2l0 0c0 0 0 0 0 2.133333C153.6 746.666667 147.2 772.266667 125.866667 782.933333z"
              p-id="3663" fill="#f5f5f5"></path>
    </svg>
    <p>页面加载中</p>
</div>
<div class="container" id="container">
<div class="bg">
    <img class="bgImg"
         id="iBgImg"
    />
</div>
<div class="fg">
    <img class="fgImg"
         id="iFgImg"
         onload="{
            document.getElementById('loadingBg').style.animation = 'fadeOut 0.3s ease-out';
            setTimeout(() => ( document.getElementById('loadingBg').style.display = 'none' ), 300);
            document.getElementById('container').style.display = 'block';
         }"
    />
    <div class="fgWhite"></div>
    <div class="fgLogo">
        <p>学习心得分享</p>
    </div>
    <div class="accountBar">
        <svg t="1582963174647" class="loading" id="loadingLogin" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
             p-id="3662">
            <path d="M955.733333 765.866667c0 0 0 2.133333 0 2.133333-12.8 21.333333-38.4 27.733333-57.6 14.933333-19.2-10.666667-27.733333-36.266667-17.066667-57.6l0 0c36.266667-64 57.6-136.533333 57.6-213.333333s-21.333333-151.466667-57.6-213.333333l0 0c-10.666667-19.2-4.266667-44.8 17.066667-57.6 21.333333-12.8 46.933333-4.266667 57.6 14.933333 0 0 0 2.133333 0 2.133333 42.666667 74.666667 68.266667 162.133333 68.266667 253.866667S998.4 691.2 955.733333 765.866667zM768 955.733333C768 955.733333 765.866667 955.733333 768 955.733333c-76.8 42.666667-164.266667 68.266667-256 68.266667s-179.2-25.6-253.866667-68.266667c0 0-2.133333 0-2.133333 0-21.333333-12.8-27.733333-38.4-14.933333-57.6 12.8-21.333333 38.4-27.733333 57.6-14.933333 0 0 0 0 2.133333 0l0 0C362.666667 917.333333 435.2 938.666667 512 938.666667s149.333333-21.333333 211.2-57.6l0 0c0 0 0 0 2.133333 0 21.333333-12.8 46.933333-4.266667 57.6 14.933333C795.733333 917.333333 789.333333 942.933333 768 955.733333zM727.466667 142.933333 727.466667 142.933333C663.466667 106.666667 590.933333 85.333333 512 85.333333s-151.466667 21.333333-213.333333 57.6l0 0c-19.2 10.666667-44.8 4.266667-57.6-17.066667C228.266667 106.666667 234.666667 81.066667 256 68.266667c0 0 2.133333 0 2.133333 0C332.8 25.6 420.266667 0 512 0s179.2 25.6 253.866667 68.266667c0 0 2.133333 0 2.133333 0 21.333333 12.8 27.733333 38.4 14.933333 57.6C772.266667 147.2 746.666667 153.6 727.466667 142.933333zM125.866667 782.933333C106.666667 795.733333 81.066667 789.333333 68.266667 768c0 0 0-2.133333 0-2.133333C25.6 691.2 0 603.733333 0 512s25.6-179.2 68.266667-253.866667c0 0 0-2.133333 0-2.133333 12.8-21.333333 38.4-27.733333 57.6-14.933333 21.333333 12.8 27.733333 38.4 14.933333 57.6 0 0 0 0 0 2.133333l0 0C106.666667 362.666667 85.333333 435.2 85.333333 512s21.333333 149.333333 57.6 211.2l0 0c0 0 0 0 0 2.133333C153.6 746.666667 147.2 772.266667 125.866667 782.933333z"
                  p-id="3663" fill="#515151"></path>
        </svg>
        <div class="notLogin" id="notLogin">
            <p onclick="openPasswordLogin()">登录 / 注册</p>
        </div>
        <div class="yetLogin" id="yetLogin">
            <p id="nk" style="font-weight: 700"></p>
            <p onclick="openPasswordChange()">更改密码</p>
            <p onclick="logout()">退出</p>
        </div>
    </div>
    <div class="content">
        <div class="bigWord">
            <p>欢迎！</p>
        </div>
        <div class="outer">
            <div class="item" onclick="window.open('https://www.yuque.com/blank-9ueh3')">
                <svg class="icon" height="200" p-id="3553" t="1582625497736"
                     version="1.1" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
                    <path d="M854.6 370.6c-9.9-39.4 9.9-102.2 73.4-124.4l-67.9-3.6s-25.7-90-143.6-98c-117.8-8.1-194.9-3-195-3 0.1 0 87.4 55.6 52.4 154.7-25.6 52.5-65.8 95.6-108.8 144.7-1.3 1.3-2.5 2.6-3.5 3.7C319.4 605 96 860 96 860c245.9 64.4 410.7-6.3 508.2-91.1 20.5-0.2 35.9-0.3 46.3-0.3 135.8 0 250.6-117.6 245.9-248.4-3.2-89.9-31.9-110.2-41.8-149.6z m-204.1 334c-10.6 0-26.2 0.1-46.8 0.3l-23.6 0.2-17.8 15.5c-47.1 41-104.4 71.5-171.4 87.6-52.5 12.6-110 16.2-172.7 9.6 18-20.5 36.5-41.6 55.4-63.1 92-104.6 173.8-197.5 236.9-268.5l1.4-1.4 1.3-1.5c4.1-4.6 20.6-23.3 24.7-28.1 9.7-11.1 17.3-19.9 24.5-28.6 30.7-36.7 52.2-67.8 69-102.2l1.6-3.3 1.2-3.4c13.7-38.8 15.4-76.9 6.2-112.8 22.5 0.7 46.5 1.9 71.7 3.6 33.3 2.3 55.5 12.9 71.1 29.2 5.8 6 10.2 12.5 13.4 18.7 1 2 1.7 3.6 2.3 5l5 17.7c-15.7 34.5-19.9 73.3-11.4 107.2 3 11.8 6.9 22.4 12.3 34.4 2.1 4.7 9.5 20.1 11 23.3 10.3 22.7 15.4 43 16.7 78.7 3.3 94.6-82.7 181.9-182 181.9z"
                          fill="#515151" p-id="3554"></path>
                </svg>
                <p>语雀</p>
            </div>
            <div class="item" onclick="window.open('https://www.github.com/herezsy')">
                <svg class="icon" height="200" p-id="4341" t="1582626318934"
                     version="1.1" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
                    <path d="M850.346667 155.008a42.666667 42.666667 0 0 0-22.741334-23.509333c-8.704-3.754667-85.717333-33.322667-200.32 39.168H396.714667c-114.773333-72.618667-191.701333-42.922667-200.32-39.168a42.88 42.88 0 0 0-22.741334 23.466666c-26.197333 66.218667-18.048 136.448-7.850666 176.896C134.272 374.016 128 413.098667 128 469.333333c0 177.877333 127.104 227.882667 226.730667 246.272a189.568 189.568 0 0 0-13.013334 46.549334A44.373333 44.373333 0 0 0 341.333333 768v38.613333c-19.498667-4.138667-41.002667-11.946667-55.168-26.112C238.08 732.416 188.330667 682.666667 128 682.666667v85.333333c25.002667 0 65.365333 40.362667 97.834667 72.832 51.029333 51.029333 129.066667 55.253333 153.386666 55.253333 3.114667 0 5.376-0.085333 6.528-0.128A42.666667 42.666667 0 0 0 426.666667 853.333333v-82.090666c4.266667-24.746667 20.224-49.621333 27.946666-56.362667a42.666667 42.666667 0 0 0-23.125333-74.581333C293.333333 624.554667 213.333333 591.488 213.333333 469.333333c0-53.12 5.632-70.741333 31.573334-99.285333 11.008-12.117333 14.08-29.568 7.978666-44.8-4.821333-11.904-18.773333-65.450667-6.485333-117.546667 20.650667-1.578667 59.904 4.565333 113.706667 40.96C367.104 253.44 375.466667 256 384 256h256a42.666667 42.666667 0 0 0 23.936-7.338667c54.016-36.522667 92.970667-41.770667 113.664-41.130666 12.330667 52.224-1.578667 105.770667-6.4 117.674666a42.666667 42.666667 0 0 0 8.021333 44.928C805.077333 398.464 810.666667 416.085333 810.666667 469.333333c0 122.581333-79.957333 155.52-218.069334 170.922667a42.666667 42.666667 0 0 0-23.125333 74.709333c19.797333 17.066667 27.861333 32.469333 27.861333 53.034667v128h85.333334v-128c0-20.437333-3.925333-38.101333-9.770667-53.12C769.92 695.765333 896 643.712 896 469.333333c0-56.362667-6.272-95.530667-37.76-137.514666 10.197333-40.405333 18.261333-110.506667-7.893333-176.810667z"
                          fill="#515151" p-id="4342"></path>
                </svg>
                <p>GitHub</p>
            </div>
        </div>
    </div>
    <div class="explain">
        <p>背景图片来源于 cn.bing.com 每日壁纸，仅作学习分享使用</p>
        <a href="http://beian.miit.gov.cn/">粤ICP备19151882号</a>
    </div>
</div>
<div class="t">
    <div class="tWord">
        <p>爱吃，爱玩，爱摸鱼</p>
    </div>
</div>
</div>
<div class="l">
    <svg t="1582961372856" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
         p-id="2267">
        <path d="M841.142857 566.857143l0 274.285714q0 14.857143-10.857143 25.714286t-25.714286 10.857143l-219.428571 0 0-219.428571-146.285714 0 0 219.428571-219.428571 0q-14.857143 0-25.714286-10.857143t-10.857143-25.714286l0-274.285714q0-0.571429 2.857143-1.714286t2.857143-1.714286l328.571429-270.857143 328.571429 270.857143q0.571429 1.142857 0.571429 3.428571zm127.428571-39.428571l-35.428571 42.285714q-4.571429 5.142857-12 6.285714l-1.714286 0q-7.428571 0-12-4l-395.428571-329.714286-395.428571 329.714286q-6.857143 4.571429-13.714286 4-7.428571-1.142857-12-6.285714l-35.428571-42.285714q-4.571429-5.714286-4-13.428571t6.285714-12.285714l410.857143-342.285714q18.285714-14.857143 43.428571-14.857143t43.428571 14.857143l139.428571 116.571429 0-111.428571q0-8 5.142857-13.142857t13.142857-5.142857l109.714286 0q8 0 13.142857 5.142857t5.142857 13.142857l0 233.142857 125.142857 104q5.714286 4.571429 6.285714 12.285714t-4 13.428571z"
              p-id="2268" fill="#f5f5f5"></path>
    </svg>
    <div class="lWord" id="welcomeWord">
        <p>tozsy.com</p>
    </div>
</div>
<div class="frameContainer" id="frameContainer">
    <iframe class="frame" id="frame"></iframe>
</div>
</body>
<script>
    let t = new XMLHttpRequest();
    t.open('GET', '/c/wallpaper', true);
    t.onreadystatechange = () => {
        if (t.readyState === 4 && t.status === 200) {
            console.log(t.responseText);
        }
    };
    t.send();
    let successInner;
    let cancelInner;
    let token;
    let secondAuthInner;
    function success() { successInner() }
    function cancel() { cancelInner() }
    function secondAuth(str) { return secondAuthInner(str) }
    // 注意跨框架只能使用函数
    function getToken() { return token }
    window.fetch('c/wallpaper', {
        method: "GET",
        credentials: 'include',
    }).then(res => res.json())
        .then(res => {
            document.getElementById("iBgImg").setAttribute("src", res['site']);
            document.getElementById("iFgImg").setAttribute("src", res['site']);
        });
    function fetchInfo() {
        window.fetch('/zsy/auth/token', {
            method: 'POST',
            credentials: 'include',
        }).then(r => r.json()).then(r => {
            if (r.state === 'success') {
                document.getElementById('nk').innerText = r.nk;
                document.getElementById('notLogin').style.display = 'none';
                document.getElementById('yetLogin').style.display = 'flex';
            } else {
                document.getElementById('yetLogin').style.display = 'none';
                document.getElementById('notLogin').style.display = 'flex';
            }
            document.getElementById('loadingLogin').style.display = 'none';
        });
    }
    fetchInfo();
    function openPasswordLogin() {
        successInner = () => {
            fetchInfo();
            document.getElementById('frameContainer').style.animation = 'fadeOut 0.1s ease-in';
            setTimeout(() => {
                document.getElementById('frameContainer').style.display = 'none';
                document.getElementById('frameContainer').style.animation = 'fadeIn 0.1s ease-in';
            }, 90);
        };
        cancelInner = () => {
            document.getElementById('frameContainer').style.animation = 'fadeOut 0.1s ease-in';
            setTimeout(() => {
                document.getElementById('frameContainer').style.display = 'none';
                document.getElementById('frameContainer').style.animation = 'fadeIn 0.1s ease-in';
            }, 90);
        };
        document.getElementById('frame').setAttribute('src', '/p/codeLogin.html');
        document.getElementById('frameContainer').style.display = 'block';
    }
    function openPasswordChange() {
        successInner = () => {
            document.getElementById('frameContainer').style.animation = 'fadeOut 0.1s ease-in';
            setTimeout(() => {
                document.getElementById('frameContainer').style.display = 'none';
                document.getElementById('frameContainer').style.animation = 'fadeIn 0.1s ease-in';
            }, 90);
            fetchInfo();
        };
        cancelInner = () => {
            document.getElementById('frameContainer').style.animation = 'fadeOut 0.1s ease-in';
            setTimeout(() => {
                document.getElementById('frameContainer').style.display = 'none';
                document.getElementById('frameContainer').style.animation = 'fadeIn 0.1s ease-in';
            }, 90);
        };
        secondAuthInner = str => {
            token = str;
            return '/p/passwordChange.html';
        };
        document.getElementById('frame').setAttribute('src', '/p/passwordAuth.html');
        document.getElementById('frameContainer').style.display = 'block';
    }
    function logout() {
        window.fetch('/zsy/auth/logout', {
            method: 'POST',
            credentials: 'include',
        }).then(r => r.json()).then(r => {
            if (r.state === 'success') {
                document.getElementById('notLogin').style.display = 'flex';
                document.getElementById('yetLogin').style.display = 'none';
            } else {
                document.getElementById('yetLogin').style.display = 'flex';
                document.getElementById('notLogin').style.display = 'none';
            }
        });
    }
</script>
</html>
